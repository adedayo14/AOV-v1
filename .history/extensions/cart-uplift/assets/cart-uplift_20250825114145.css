/* Cart Uplift – COMPLETE REWRITE
   Visual style matches the “reference” screenshot.
   Interaction safety: robust z-index, fixed backdrop, no theme blur leakage.
*/

/* =========================
   Container & Backdrop
   ========================= */
#cartuplift-app-container {
  position: fixed;
  inset: 0;
  width: 100%;
  height: 100%;
  z-index: 2147483000; /* extremely high, but below popup/drawer */
  display: none;
  pointer-events: none;
}

#cartuplift-app-container.cartuplift-active {
  display: block !important;
  pointer-events: auto !important;
}

#cartuplift-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.5);
  z-index: 2147483001;
  animation: cuFadeIn .25s ease-out;
}

#cartuplift-backdrop.is-closing {
  animation: cuFadeOut .2s ease-in forwards;
}

#cartuplift-cart-popup {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  width: 420px;
  max-width: 92vw;
  z-index: 2147483002;  /* above backdrop */
}

/* =========================
   Global blur neutraliser
   ========================= */
html.cartuplift-drawer-open *:not(#cartuplift-app-container):not(#cartuplift-app-container *){
  -webkit-filter: none !important;
  filter: none !important;
  -webkit-backdrop-filter: none !important;
  backdrop-filter: none !important;
  opacity: 1 !important;
  pointer-events: auto;
}

/* Prevent scroll jump on page when drawer is open */
html.cartuplift-drawer-open, html.cartuplift-drawer-open body {
  overflow: hidden !important;
}

/* =========================
   Drawer Shell
   ========================= */
.upcart-cart.cu-cart {
  height: 100vh;
  background: #fff;
  display: flex;
  flex-direction: column;
  transform: translateX(100%);
  box-shadow: -4px 0 20px rgba(0,0,0,.15);
}

/* open/close animations */
.upcart-cart.is-open  { animation: cuSlideIn  .25s ease-out forwards; }
.upcart-cart.is-closing { animation: cuSlideOut .2s ease-in forwards; }

/* =========================
   Header
   ========================= */
.cu-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 20px;
  border-bottom: 1px solid #E6E6E6;
  background: #fff;
}
.cu-title { font-weight: 800; letter-spacing: .02em; color:#111; }
.cu-count { color:#6b7280; font-weight: 600; }
.cu-close {
  border: none; background: transparent; cursor: pointer;
  width: 32px; height: 32px; font-size: 24px; line-height: 1; color:#333;
}
.cu-close:hover { color:#000; }

/* =========================
   Free shipping bar
   ========================= */
.cu-freebar { padding: 10px 20px; background: #F1FAF3; border-bottom: 1px solid #E6E6E6; }
.cu-freebar-msg { font-size: 14px; font-weight: 700; color:#0A5; margin-bottom: 8px; text-align: left; }
.cu-freebar-track { height: 8px; background:#E8F5EC; border-radius: 999px; overflow: hidden; }
.cu-freebar-fill { height: 100%; width: 0; background: #22c55e; transition: width .3s ease; }

/* =========================
   Items
   ========================= */
.upcart-items.cu-items { flex:1; overflow: auto; background:#fff; }
.cu-lineitems { display: flex; flex-direction: column; }

.cu-item {
  display: grid;
  grid-template-columns: 80px 1fr auto 24px;
  gap: 12px;
  align-items: center;
  padding: 16px 20px;
  border-bottom: 1px solid #F0F0F0;
}
.cu-thumb { width: 80px; height: 80px; border-radius: 10px; overflow: hidden; margin: 0; background:#f6f6f6; }
.cu-thumb img { width: 100%; height: 100%; object-fit: cover; display:block; }

.cu-meta { min-width: 0; }
.cu-name { display:block; color:#111; text-decoration: none; font-weight: 700; }
.cu-name:hover { text-decoration: underline; }
.cu-variant { margin-top: 4px; font-size: 12px; color:#6b7280; }

.cu-qtywrap {
  margin-top: 8px;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 8px;
  border: 1px solid #ddd;
  border-radius: 999px;
}
.cu-step {
  width: 28px; height: 28px;
  border: none; background: #fff; cursor: pointer;
  font-size: 18px; line-height: 1; border-radius: 50%;
}
.cu-qty {
  width: 34px; border: none; background: transparent;
  text-align: center; font-size: 14px;
}
.cu-qty:focus { outline: none; }

.cu-price { font-weight: 800; color:#111; }

.cu-remove {
  border: none; background: transparent; cursor: pointer;
  font-size: 20px; line-height: 1; color:#666;
}
.cu-remove:hover { color:#000; }

.cu-item.loading { opacity: .6; pointer-events: none; }

/* =========================
   Recommended (simple cards)
   ========================= */
.cu-recos { padding: 12px 16px; background: #F3F2EF; }
.cu-recos-head { display:flex; align-items:center; justify-content:space-between; margin: 0 4px 8px; }
.cu-recos-head span { font-size: 12px; font-weight: 800; letter-spacing:.06em; color:#222; }
.cu-recos-toggle { border:none; background:transparent; cursor:pointer; font-size:18px; transform: rotate(0deg); transition: transform .2s; }
.cu-recos-toggle[aria-expanded="false"] { transform: rotate(-90deg); }

.cu-recos-list { display:grid; grid-template-columns: 1fr 1fr; gap: 12px; }
.cu-reco { background:#fff; border-radius: 12px; padding: 12px; box-shadow: 0 1px 2px rgba(0,0,0,.05); }
.cu-reco-img { width: 100%; aspect-ratio: 1 / 1; object-fit: cover; border-radius: 10px; }
.cu-reco-title { margin-top: 8px; font-size: 14px; font-weight: 700; color:#111; }
.cu-reco-row { margin-top: 6px; display:flex; align-items:center; justify-content: space-between; }
.cu-reco-price { font-weight: 800; }
.cu-reco-add {
  border: 1px solid #111; background:#fff; color:#111; font-weight: 800;
  padding: 6px 10px; border-radius: 999px; cursor: pointer;
}
.cu-reco-add:disabled { opacity:.5; cursor: not-allowed; }

/* =========================
   Footer, Subtotal & Wallets
   ========================= */
.upcart-footer.cu-footer { border-top: 1px solid #E6E6E6; padding: 16px 20px; background:#fff; }
.cu-subtotal { display:flex; align-items:center; justify-content: space-between; font-weight: 800; margin-bottom: 12px; }
.cu-subtotal-amount { font-weight: 800; }

.cu-checkout {
  width: 100%; padding: 14px 18px; border: none; border-radius: 10px;
  background: #111; color:#fff; font-weight: 900; letter-spacing:.02em; cursor: pointer;
}
.cu-checkout:hover { background:#000; }

.cu-accelerated { display:grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 12px; }
.cu-wallet { padding: 12px 10px; border: none; border-radius: 12px; font-weight: 900; cursor: pointer; }
.cu-wallet--paypal { background: #FFCC00; }
.cu-wallet--shop { background: #6C3AF2; color:#fff; }
.cu-wallet--shop span { background:#fff; color:#6C3AF2; padding: 2px 6px; margin-left:2px; border-radius: 6px; }

/* Notes expander */
.cu-note-toggle {
  margin-top: 12px; width: 100%; text-align: center; background:#EFEDE8;
  border: none; border-radius: 10px; padding: 10px; cursor: pointer; font-weight: 700;
}
.cu-note-area { margin-top: 10px; }

/* =========================
   Sticky cart button
   ========================= */
#upcart-sticky { position: fixed; z-index: 2147482900; transition: transform .2s ease, box-shadow .2s ease; }
#upcart-sticky.bottom-right { bottom: 20px; right: 20px; }
#upcart-sticky.bottom-left  { bottom: 20px; left: 20px; }
#upcart-sticky.middle-right { top: 50%; right: 20px; transform: translateY(-50%); }
#upcart-sticky.middle-left  { top: 50%; left: 20px; transform: translateY(-50%); }

.upcart-trigger {
  display: flex; align-items: center; gap: 8px;
  padding: 12px 18px; border-radius: 999px; background:#111; color:#fff; border:none; cursor:pointer;
  box-shadow: 0 6px 16px rgba(0,0,0,.2); font-weight: 700;
}
.upcart-trigger:hover { transform: scale(1.05); box-shadow: 0 8px 20px rgba(0,0,0,.25); }
.upcart-trigger svg { width: 20px; height: 20px; fill: currentColor; }
.upcart-count { background:#ff4444; color:#fff; border-radius: 10px; padding: 2px 6px; font-size: 12px; font-weight: 800; min-width: 20px; text-align:center; }
.upcart-total { font-weight: 800; }

/* =========================
   Animations
   ========================= */
@keyframes cuSlideIn   { from { transform: translateX(100%);} to { transform: translateX(0);} }
@keyframes cuSlideOut  { from { transform: translateX(0);}     to { transform: translateX(100%);} }
@keyframes cuFadeIn    { from { opacity: 0; } to { opacity: 1; } }
@keyframes cuFadeOut   { from { opacity: 1; } to { opacity: 0; } }

/* =========================
   Responsive
   ========================= */
@media (max-width: 768px){
  #cartuplift-cart-popup { width: 100%; max-width: 100vw; }
  .cu-item { grid-template-columns: 72px 1fr auto 24px; padding: 12px 16px; }
  .cu-thumb { width: 72px; height: 72px; }
}

/* =========================
   Print
   ========================= */
@media print {
  #cartuplift-app-container, #upcart-sticky { display: none !important; }
}
